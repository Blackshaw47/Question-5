import random
from datetime import datetime, timedelta

def generate_random_date():
    
    return datetime.now() + timedelta(days=random.randint(1, 30))

def generate_random_task():
   
    return {'progress': random.randint(0, 100)}

def generate_random_job(job_title):
 
    num_tasks = random.randint(10, 20)
    tasks = [generate_random_task() for _ in range(num_tasks)]
    return {'title': job_title, 'tasks': tasks, 'end_date': generate_random_date()}

def calculate_overall_progress(job):
   
    if not job['tasks']:
        return 0
    progress_sum = sum(task['progress'] for task in job['tasks'])
    return progress_sum / (len(job['tasks']*100))

jobs = [generate_random_job(f'Job{i}') for i in range(1, 11)]

sorted_jobs = sorted(jobs, key=lambda job: (job['end_date'], calculate_overall_progress(job)), reverse=True)


for job in sorted_jobs:
    overall_progress = calculate_overall_progress(job)
    print(f"Job: {job['title']}, End Date: {job['end_date'].strftime('%Y-%m-%d')}, Overall Progress: {overall_progress:.2%}")
